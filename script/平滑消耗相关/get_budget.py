import sys
import json
import datetime
f=sys.argv[1]
fr = open(f,'r')

dict_planid = {}
#30
# online_planid = set([182403,187550,189139,186369,187771,189573,188998,189470,177564,189039,186278,187551,187646,185696,184925,185624,189817,186289,182221,189432,189846,185569,188134,189867,187547,186575,186026,56852,186698,185919])
#60
#online_planid = set([46584,52279,56852,66530,72524,75920,80443,84351,109140,112507,115855,118737,119300,130946,140404,141469,146199,148435,148871,149362,151560,151718,156088,156553,157125,157954,159444,160938,161281,161596,42790,43585,46025,64973,69633,70908,88064,90735,94730,102113,106008,111354,118856,121505,122622,123831,124080,125661,137860,143387,146555,151089,153893,160177,160960,163172,164293,164330,165628,168419])
#41
online_planid = set([188511,190505,187130,174335,186026,185696,186924,189844,184165,187215,180430,190523,64973,190594,189213,186599,185343,186307,189360,185624,185576,187547,189672,186288,184925,189596,56852,183031,189734,189840,148560,187159,185282,185897,187551,190600,182221,189861,190512,189038,185580,178147,189848,189262,178005,188959,189039,43585,189888,187550,183583,188442,188435,164336,178890,184416,190826,175542,179917,190503,168812,189521,186032,190492,187442,187451,190462,190321,190532,109140,190284,189543,189385,182309,187395,190292,189151,5890,164269,186575,189746,189048,189849,185575,189155,189061,189769,190097,153536,190400,189152,190497,189750,163180,186022,187066,185270,189325,183012,185198,186698,189843,146555,189101,189216,189845,178811,189219,179509,190890,189442,190717,191176,189220,190677,184984,189762,187080,97621,190510,])

for l in fr:
    l=json.loads(l.strip())
    if l.has_key("time") and l.has_key("obj"):
        if l['obj'].has_key("turn") and l['obj'].has_key("budget") and l['obj'].has_key("id"):
            # print l['obj']['id'],datetime.datetime.utcfromtimestamp(l["time"]/1000).strftime("%Y--%m--%d %H:%M:%S"),\
            # l['obj']['budget'],l['obj']['turn']
            planid = int(l['obj']['id'])
            # if planid in online_planid:
            #     online_planid.remove(planid)
            time = datetime.datetime.fromtimestamp(l["time"]/1000).strftime("%H:%M:%S")
            budget = l['obj']['budget']
            turn = l['obj']['turn']
            if planid in online_planid:
                dict_planid.setdefault(str(planid)+","+str(time), [budget,turn])

for key in sorted(dict_planid.keys()):
    print key+","+str(dict_planid[key][0])+","+str(dict_planid[key][1])

# print online_planid

