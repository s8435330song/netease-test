argument: key(conf), value(/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/)
argument: key(sDt), value(2018-12-09)
argument: key(eDt), value(2018-12-09)
SparkBatch init() configDir=/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/
Initializing spark component...
Loading spark_component component config from /home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/spark.conf
Initializing new spark context with name Rank_rank_query_osappv_algo...
Use KryoSerializer conf
This app use spark sql
ModelBatchComponent init() configDir=/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/
Initializing model component ... 
Loading model_component component config from /home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/model.conf
Starting...
The App start to run.
INFO: fetch files from path /user/algo/songyang1/serverLog/2018-12-09/*
sbc rddcontext info serverLogRDD
Finish set hdfs://hz-cluster9/user/algo/songyang1/serverLog/2018-12-09/test.lzo to serverLogRDD RDD with lzo format
root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- exp_ids: string (nullable = true)
 |-- location_count: integer (nullable = false)
 |-- diversity_type: string (nullable = true)
 |-- latency: long (nullable = false)
 |-- request_time: long (nullable = false)
 |-- response_time: long (nullable = false)
 |-- total_ids_count: integer (nullable = false)
 |-- unique_ids_count: integer (nullable = false)
 |-- truncate_flag: string (nullable = true)
 |-- truncate_account: string (nullable = true)
 |-- truncate_plan: string (nullable = true)
 |-- exp_layers: string (nullable = true)
 |-- processors: string (nullable = true)
 |-- process_time: map (nullable = true)
 |    |-- key: string
 |    |-- value: integer (valueContainsNull = false)
 |-- ad_num: integer (nullable = false)
 |-- parse: integer (nullable = false)
 |-- make: integer (nullable = false)
 |-- ext: map (nullable = true)
 |    |-- key: string
 |    |-- value: string (valueContainsNull = true)
 |-- host: string (nullable = true)
 |-- time: long (nullable = false)

root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- request_time: string (nullable = true)
 |-- os: string (nullable = true)
 |-- appv: string (nullable = true)

root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- exp_name: string (nullable = true)
 |-- location: string (nullable = true)
 |-- scheduling_id: string (nullable = true)
 |-- account_id: string (nullable = true)
 |-- idea_id: string (nullable = true)
 |-- idea_type: string (nullable = true)
 |-- bid: double (nullable = false)
 |-- ctr: double (nullable = false)
 |-- rank_ctr: double (nullable = false)
 |-- orig_ctr: double (nullable = false)
 |-- ecpm: double (nullable = false)
 |-- rank_ecpm: double (nullable = false)
 |-- ecpm2_idea_id: long (nullable = false)
 |-- ecpm2: double (nullable = false)
 |-- flag: integer (nullable = false)
 |-- random: double (nullable = false)
 |-- win_price: double (nullable = false)
 |-- new_win_price: double (nullable = false)
 |-- w: double (nullable = false)
 |-- pw: double (nullable = false)
 |-- lw: double (nullable = false)
 |-- factor_wp_ratio: double (nullable = false)
 |-- wp_ratio: double (nullable = false)
 |-- new_wp_ratio: double (nullable = false)
 |-- cvr: double (nullable = false)
 |-- size: integer (nullable = false)
 |-- ext: map (nullable = true)
 |    |-- key: string
 |    |-- value: string (valueContainsNull = true)
 |-- host: string (nullable = true)
 |-- time: long (nullable = false)

location********************************************
[32,194]
[31,188]
[115,1]
[null,107]
[304,3]
[34,196]
[40,17]
[41,1]
[75,332]
[11,47]
[131,141]
[22,4]
[50,994]
[2,78]
[23,1]
[39,14]
[1,291]
[3,87]
[114,1]
[12,29]
[37,202]
[36,164]
[4,1947]
[35,187]
[33,206]
[20,141]
[38,161]
location_ount location check diff ********************************************
[2,null,null]
[2,1,52.0]
[2,101,38.95]
[2,102,40.89473684210526]
[2,2,52.0]
[2,21,79.63636363636364]
[2,22,79.63636363636364]
[2,301,63.0]
[2,302,63.0]
[2,4,83.0]
[2,50,76.0]
[2,51,93.66216216216216]
[2,52,94.29251700680273]
[2,53,41.9]
[2,54,45.80952380952381]
[3,20,14.0]
[3,200,95.0]
[3,201,95.0]
[3,202,95.0]
[3,21,9.75]
[3,22,29.8]
[3,25,110.0]
[3,28,110.0]
[3,301,82.5]
[3,302,82.5]
[3,303,82.5]
[5,null,null]
[5,1,47.76190476190476]
[5,2,52.31578947368421]
[5,3,52.10526315789474]
[5,4,54.833333333333336]
[5,5,57.64705882352941]
[6,null,null]
[6,20,36.8]
[6,21,80.26923076923077]
[6,22,79.88888888888889]
[6,23,15.222222222222221]
[6,24,74.3125]
[6,25,69.16666666666667]
[6,26,57.7]
[6,27,97.9090909090909]
[6,28,97.9090909090909]
[6,29,73.46666666666667]
[7,20,127.0]
[7,21,67.875]
[7,22,58.833333333333336]
[7,23,23.0]
[7,24,23.0]
[7,25,48.90909090909091]
[7,26,58.833333333333336]
[7,27,58.833333333333336]
[7,28,58.166666666666664]
[7,29,70.77777777777777]
[8,20,4.5]
[8,21,142.66666666666666]
[8,22,108.125]
[8,23,123.28571428571429]
[8,24,123.28571428571429]
[8,25,142.66666666666666]
[8,26,142.66666666666666]
[8,27,142.66666666666666]
[8,28,142.66666666666666]
[9,null,null]
[9,20,115.29591836734694]
[9,21,116.59016393442623]
[9,22,115.7479674796748]
[9,23,118.66115702479338]
[9,24,119.14754098360656]
[9,25,122.94067796610169]
[9,26,124.74137931034483]
[9,27,124.74137931034483]
[9,28,126.70175438596492]
[9,30,116.3157894736842]
[10,null,null]
[10,110,92.59375]
[10,111,93.5578947368421]
[10,112,94.53191489361703]
[10,113,96.43478260869566]
[10,114,98.43333333333334]
[10,115,100.8314606741573]
[10,116,100.52173913043478]
[10,117,101.66666666666667]
[10,118,103.29347826086956]
[10,119,104.26373626373626]
[10,120,82.74074074074075]
[10,121,85.84615384615384]
[10,122,89.0]
[10,123,87.46428571428571]
[10,124,90.51851851851852]
[10,125,93.65384615384616]
[10,126,93.65384615384616]
[10,127,93.65384615384616]
[10,128,96.92]
[10,129,96.92]
[10,130,111.125]
[10,131,111.125]
[10,132,111.125]
[10,133,111.125]
[10,134,111.125]
[10,135,118.66666666666667]
[10,136,118.66666666666667]
[10,137,118.66666666666667]
[10,138,131.125]
[10,139,131.125]
[10,20,133.19678714859438]
[10,21,131.57551020408164]
[10,22,133.1818181818182]
[10,23,133.4959677419355]
[10,24,134.03238866396762]
[10,25,136.12345679012347]
[10,26,136.1440329218107]
[10,27,137.73333333333332]
[10,28,138.7219917012448]
[10,29,138.7191489361702]
[10,30,102.93333333333334]
[12,200,52.25]
[12,201,52.25]
[12,202,52.25]
[12,23,101.5]
[12,24,101.5]
[12,25,101.5]
[12,26,101.5]
[12,27,101.5]
[12,28,101.5]
[12,29,27.333333333333332]
[12,30,52.25]
[12,31,52.25]
[18,null,null]
[18,1,45.1]
[18,10,55.125]
[18,11,55.125]
[18,12,55.125]
[18,13,57.0]
[18,14,57.0]
[18,15,58.68181818181818]
[18,16,62.0]
[18,17,63.578947368421055]
[18,18,67.88235294117646]
[18,2,49.77777777777778]
[18,3,51.61538461538461]
[18,4,51.5]
[18,5,50.12]
[18,6,51.61538461538461]
[18,7,55.125]
[18,8,55.125]
[18,9,55.125]
[20,20,63.142857142857146]
[20,21,63.142857142857146]
[20,22,63.4]
[20,23,63.4]
[20,24,63.4]
[20,25,63.4]
[20,26,63.4]
[20,27,63.4]
[20,28,63.4]
[20,29,63.4]
[20,70,63.4]
[20,71,63.4]
[20,72,63.4]
[20,73,63.4]
[20,74,63.4]
[20,75,63.4]
[20,76,63.4]
[20,77,63.4]
[20,78,63.4]
[20,79,63.4]
[40,110,112.11111111111111]
[40,111,112.11111111111111]
[40,112,112.11111111111111]
[40,113,112.11111111111111]
[40,114,112.11111111111111]
[40,115,112.11111111111111]
[40,116,112.11111111111111]
[40,117,112.11111111111111]
[40,118,112.11111111111111]
[40,119,121.5]
[40,120,121.5]
[40,121,121.5]
[40,122,121.5]
[40,123,121.5]
[40,124,121.5]
[40,125,121.5]
[40,126,121.5]
[40,127,112.22222222222223]
[40,128,121.5]
[40,129,121.5]
[40,130,129.57142857142858]
[40,131,141.5]
[40,132,141.5]
[40,133,151.8]
[40,134,151.8]
[40,135,151.8]
[40,136,151.8]
[40,137,163.5]
[40,138,163.5]
[40,139,163.5]
[40,20,111.44444444444444]
[40,21,112.22222222222223]
[40,22,116.875]
[40,23,112.11111111111111]
[40,24,112.11111111111111]
[40,25,112.11111111111111]
[40,26,112.11111111111111]
[40,27,112.11111111111111]
[40,28,112.11111111111111]
[40,29,112.11111111111111]
location_ount unique_ids_count average********************************************
[1,47.756016742239275]
[2,81.33161953727506]
[3,51.125]
[5,51.381443298969074]
[6,42.15945945945946]
[7,58.833333333333336]
[8,127.4074074074074]
[9,112.87045309508615]
[10,99.27619370898394]
[12,101.5]
[18,52.731898238747554]
[20,59.50397877984085]
[40,120.86774193548388]
rid unique_ids_count distribution********************************************
[1,2333]
[2,180]
[3,165]
[4,110]
[5,129]
[6,50]
[7,64]
[8,174]
[9,109]
[10,131]
[11,65]
[12,86]
[13,96]
[14,82]
[15,67]
[16,66]
[17,59]
[18,93]
[19,79]
[20,92]
[21,87]
[22,140]
[23,113]
[24,133]
[25,110]
[26,75]
[27,102]
[28,170]
[29,185]
[30,84]
[31,195]
[32,164]
[33,155]
[34,103]
[35,124]
[36,85]
[37,141]
[38,134]
[39,142]
[40,81]
[41,67]
[42,122]
[43,115]
[44,104]
[45,103]
[46,109]
[47,144]
[48,124]
[49,113]
[50,106]
[51,121]
[52,81]
[53,136]
[54,89]
[55,104]
[56,121]
[57,140]
[58,180]
[59,72]
[60,97]
[61,145]
[62,150]
[63,90]
[64,82]
[65,122]
[66,130]
[67,110]
[68,112]
[69,102]
[70,56]
[71,109]
[72,87]
[73,126]
[74,104]
[75,123]
[76,85]
[77,84]
[78,119]
[79,114]
[80,73]
[81,78]
[82,143]
[83,76]
[84,79]
[85,95]
[86,44]
[87,110]
[88,68]
[89,47]
[90,89]
[91,79]
[92,63]
[93,99]
[94,78]
[95,72]
[96,61]
[97,81]
[98,94]
[99,32]
[100,44]
[101,40]
[102,61]
[103,77]
[104,54]
[105,121]
[106,64]
[107,52]
[108,72]
[109,31]
[110,37]
[111,72]
[112,55]
[113,57]
[114,51]
[115,61]
[116,61]
[117,33]
[118,43]
[119,120]
[120,31]
[121,54]
[122,45]
[123,53]
[124,32]
[125,99]
[126,49]
[127,78]
[128,56]
[129,67]
[130,80]
[131,103]
[132,45]
[133,58]
[134,20]
[135,54]
[136,78]
[137,20]
[138,70]
[139,63]
[140,84]
[141,60]
[142,83]
[143,55]
[144,95]
[145,29]
[146,72]
[147,54]
[148,47]
[149,22]
[150,44]
[151,88]
[152,42]
[153,28]
[154,82]
[155,16]
[156,62]
[157,42]
[158,81]
[159,43]
[160,38]
[161,73]
[162,31]
[163,27]
[164,46]
[165,32]
[166,44]
[167,7]
[168,32]
[169,59]
[170,18]
[171,50]
[172,32]
[173,59]
[174,33]
[175,61]
[176,44]
[177,10]
[178,21]
[179,30]
[180,37]
[181,18]
[182,16]
[183,46]
[184,41]
[185,24]
[186,26]
[187,31]
[188,30]
[189,25]
[190,17]
[191,33]
[192,34]
[193,16]
[194,67]
[195,32]
[196,19]
[197,16]
[198,16]
[199,32]
[200,27]
[201,25]
[202,32]
[203,43]
[204,15]
[205,13]
[206,32]
[207,29]
[208,13]
[209,11]
[210,26]
[211,3]
[212,4]
[213,31]
[214,15]
[215,11]
[216,24]
[217,3]
[218,24]
[219,4]
[220,31]
[221,13]
[222,16]
[223,22]
[224,14]
[225,10]
[226,13]
[227,16]
[228,11]
[229,4]
[230,22]
[231,3]
[232,43]
[234,14]
[235,12]
[236,12]
[237,11]
[238,3]
[239,1]
[240,6]
[241,21]
[242,14]
[243,3]
[244,23]
[245,2]
[246,2]
[248,5]
[249,22]
[250,13]
[251,31]
[252,19]
[253,7]
[254,21]
[255,21]
[256,11]
[258,1]
[259,4]
[260,20]
[261,1]
[262,20]
[263,4]
[264,12]
[265,19]
[266,12]
[267,13]
[268,14]
[269,11]
[270,21]
[271,19]
[273,22]
[274,1]
[275,11]
[276,1]
[277,21]
[278,9]
[279,1]
[280,11]
[281,1]
[282,20]
[283,11]
[284,2]
[285,2]
[286,1]
[289,9]
[292,1]
[293,13]
[294,9]
[295,40]
[296,1]
[300,13]
[302,9]
[303,12]
[304,3]
[305,10]
[306,11]
[308,1]
[312,1]
[314,2]
[316,10]
[319,2]
[321,10]
[323,10]
[328,10]
[332,9]
[336,1]
[345,1]
[349,1]
[353,1]
[356,2]
[357,1]
[369,1]
[370,10]
[377,1]
Filter stat join query count is 5734
All process is finish !
