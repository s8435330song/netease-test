argument: key(conf), value(/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/)
argument: key(sDt), value(2018-11-09)
argument: key(eDt), value(2018-11-09)
SparkBatch init() configDir=/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/
Initializing spark component...
Loading spark_component component config from /home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/spark.conf
Initializing new spark context with name Rank_rank_query_osappv_algo...
Use KryoSerializer conf
This app use spark sql
ModelBatchComponent init() configDir=/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/
Initializing model component ... 
Loading model_component component config from /home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/model.conf
Starting...
The App start to run.
INFO: fetch files from path /datastream/algo/rankserver/log/server/2018-11-09/*
sbc rddcontext info serverLogRDD
Finish set hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-11-09/ad_pangu_rankserver_server_20181109-000000107+0800.73476537457675610.00000373-1692878463--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-11-09/ad_pangu_rankserver_server_20181109-000000208+0800.17120159721155876.00000266-1106072449--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-11-09/ad_pangu_rankserver_server_20181109-000000376+0800.17672964368948128.00000283--2024097861--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-11-09/ad_pangu_rankserver_server_20181109-000000593+0800.52236298454558426.00000205-1915806332--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-11-09/ad_pangu_rankserver_server_20181109-000000611+0800.53434100728119506.00000725-1270392737--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-11-09/ad_pangu_rankserver_server_20181109-000000631+0800.17120147814066326.00000584-1235155168--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-11-09/ad_pangu_rankserver_server_20181109-000000680+0800.43942420305642752.00000407-1563795744--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-11-09/ad_pangu_rankserver_server_20181109-000000763+0800.17672952721898977.00000175-2141786716--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-11-09/ad_pangu_rankserver_server_20181109-000000798+0800.53434608041571637.00000703-1528558175--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-11-09/ad_pangu_rankserver_server_20181109-000000834+0800.53434600192083640.00000380-1399475456--1193959466.lzo to serverLogRDD RDD with lzo format
root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- exp_ids: string (nullable = true)
 |-- location_count: integer (nullable = false)
 |-- diversity_type: string (nullable = true)
 |-- latency: long (nullable = false)
 |-- request_time: long (nullable = false)
 |-- response_time: long (nullable = false)
 |-- total_ids_count: integer (nullable = false)
 |-- unique_ids_count: integer (nullable = false)
 |-- truncate_flag: string (nullable = true)
 |-- truncate_account: string (nullable = true)
 |-- truncate_plan: string (nullable = true)
 |-- exp_layers: string (nullable = true)
 |-- processors: string (nullable = true)
 |-- process_time: map (nullable = true)
 |    |-- key: string
 |    |-- value: integer (valueContainsNull = false)
 |-- ad_num: integer (nullable = false)
 |-- parse: integer (nullable = false)
 |-- make: integer (nullable = false)
 |-- ext: map (nullable = true)
 |    |-- key: string
 |    |-- value: string (valueContainsNull = true)
 |-- host: string (nullable = true)
 |-- time: long (nullable = false)

root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- request_time: string (nullable = true)
 |-- os: string (nullable = true)
 |-- appv: string (nullable = true)

root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- request_time: string (nullable = true)
 |-- size: string (nullable = true)
 |-- location: string (nullable = true)

os
[null,28]
[2,19945524]
[1,19342698]
[3,13968461]
[5,537759]
appv
[28.1,16475]
[5.3.0,2100]
[5.1.2,12]
[3.3.4,2]
[6.5.7.1250,1288]
[CQk1OGM5ZDk2NzI3ZGZiZDNiCTVFRjdOMTdCMjMwMDMyNTM%3D,2]
[CQk2MjczODMzNDVjMjExZTU3CWMzMzU5MGQ0MDUwNA%3D%3D,1]
[CQk0NjA3MjUwZDE3NzNlYzExCTU0NGM4YWNl,1]
[34.5,2058]
[41.0,255667]
[6.0.5.1120,334]
[null,28]
[5.5.3,2]
[5.1.6,51]
[4.3.0,11]
[21.0,8243]
[CQk2MWU5OGM4MTFlYjE0YWE4CTRZWTdOMTc2MTMwMDI4MTc%3D,1]
[19.4,18]
[6.1.1.1143,45]
[40.0,211598]
[49.0,1]
[9.9.9,3]
[3.8.6,49]
[CQljOTQwZmU1Y2IwNzdlOWQJM0hYMDIxNkMxODAwMzU0NQ%3D%3D,1]
[3.8.7,5996]
[5.6.1.1062,327]
[4.1.5,6]
[3.5,17]
[5.5.0,704]
[3.2.5,1]
[5.5.3.1050,384]
[6.9.1/147,61]
[35.0,2974]
[5.4.3,6192]
[5.4.4,939]
[5.1.5,38]
[0.0.0,55089]
[34.1.1,24068]
[5.4.5,339]
[5.4.7,3118]
[20.0,1922]
[29.1,137877]
[3.6,52]
[37.2,255994]
[3.8.2,127]
[24.0,9702]
[3.7,33]
[22.2,54]
[CQkyZWM0ZTkxNGY5ZmI2NWZjCWQxMTBkODc3,1]
[6.7.1/143,1726]
[31.0,108054]
[6.6.8.8,443]
[4.0.3,17]
[1.5,8]
[30.1.0,2]
[,626112]
[5.0.4,1]
[CQliOTNlMWE5NzQwNjA2NzcJRkE3QlMxNzAxNTM3,1]
[CQkxNmYyNjFmNTk1N2VhYzVkCVJKQzVUMTc5MjMwMTYyOTA%3D,2]
[6.5.8/141,312]
[20.1,11243]
[38.0,215621]
[5.0.6,59]
[5.5.2.1041,430]
[35.1,192544]
[6.5.2/137,200]
[5.1.1,7]
[CQk1NjAyM2NjNDdkMmQ4MTAxCVM5QjdOMTc1MDgwMTAzMjc%3D,5]
[33.1,176938]
[6.0.3.1100,650]
[CQk0OGY4MDFjNWNlODU3MzVlCTk4ODk1NDMyNDI1YTQzNDc0ZA%3D%3D,1]
[6.0.6.1127,477]
[33.2.1,70290]
[6.1.2.1145,1297]
[5.4.2,2531]
[5.1.0,6]
[CQk2MDQ5YmM4ZWNkZjg1MWJjCU1RTTlYMTgzMjVDMTk5ODc%3D,1]
[4.1.1,4]
[6.8.3.1303,3509]
[QQ_news_CPD1,1]
[4.5.0,10]
[23.0,11080]
[6.0.1/126,3]
[48.0,74]
[3.8.0,182]
[huawei_news,1]
[5.0.5,12]
[39.0,98832]
[33.3,2744]
[6.0.2/127,124]
[CQk5NjNhZTNmMDIyM2U4Y2ZkCTY0ZmRkZWY%3D,1]
[4.0.0,2]
[5.4.6,79]
[22.0,6082]
[6.8.3/146,2293]
[24.1,24662]
[6.3.1.1177,2744]
[6.5.1/136,14]
[28.2,95060]
[33.2,640104]
[CQkzNjc4OWJlMTI1NGQzMTVmCTNIWEdMMTdBMTcwMDAwODI%3D,1]
[19.3,2]
[26.1,52860]
[6.8.1/144,60]
[43.1,952684]
[5.0.2,48]
[CQljNzhlNWViZGZmYTE4NjBkCTE1NmM0ZmU%3D,1]
[3.3,7]
[44.0,589586]
[3.8.5,299]
[5.2.7,473]
[23.1,8866]
[31.2,30521]
[5.2.1,29]
[3.8.4,4]
[39.1,94250]
[1.0,25225625]
[45.0,903878]
[4.1.6,2]
[5.5.1,2541]
[6.9.1.1314,165341]
[28.0,28708]
[37.1,41382]
[baidu_cpd1_news,2]
[29.1.0,1176]
[CQkxMmI0NjFjOWRlZmYwYWZjCWEyMTlmMjBh,2]
[3.2,157]
[41.0.0,1855]
[6.0.5/130,153]
[5.2.5,403]
[25.0.0,30]
[36.0,85827]
[CQliNmFlMDQ1OWRjM2QzYWZkCWU0Mzg5MjQz,3]
[25.1,11343]
[5.2.0,10]
[33.3.0,37]
[45.1,9445781]
[46.0,229226]
[22.1,28824]
[5.1.3,69]
[CQk5ODA0ZWM3NTQyNDQyZjk0CUxFWTdBMDY0MjAwNzE3NjA%3D,1]
[34.1,19490]
[999.9,3]
[28.2.0,511]
[25.1.0,687]
[3.8.1,153]
[tie_notify,6]
[5.2.6,82]
[21.1,24]
[CQkxNGNkOWUxYTYzNDNhZTcwCWU4MmY5MGE4,1]
[6.8.1.1292,2955]
[CQk2MDY3MGJhOTQ3YzE2YWVkCTY5ZjQ3MGZm,1]
[CQlkZDBiNjVhZjgxNmUyOTAzCUVFQTZCQUVRWTVRT1FLN1M%3D,1]
[6.2.1.1162,1077]
[32.1,39952]
[6.5.7/140,50]
[6.5.4/139,17]
[6.0.3/128,18]
[5.7.3.1086,1569]
[CQk3YTZhYzhhMWU0ZGY4NzJlCU9SUU9JQk1KNVBWODhERFk%3D,1]
[26.1.0,10]
[5.2.9,774]
[27.0,53447]
[4.1.4,1]
[47.0,56929]
[6.1.1/131,304]
[6.10.1_vip.19,2]
[5.2.8,634]
[CQllM2I1MTI1YjhmMGE5MzJmCVNKRTdOMTc3MjQwMDA1NTA%3D,3]
[34.0,105194]
[6.4.1.1188,1840]
[5.2.3,102]
[19.1,38]
[CQlhM2Q3MjkxN2MwZmVkODFkCUJZRk5XMTcyMTMwMDA1OTQ%3D,4]
[5.4.1,1868]
[5.0.0,4]
[26.2.0,242]
[5.7.3/125,330]
[25.0,40169]
[6.5.3.1210,2067]
[5.5.5,38527]
[29.0,5392]
[28.1.0,350]
[4.1.2,15]
[26.0,3132]
[4.6.1,18]
[4.0.1,6]
[CQkzOTMyZmIzY2I0YTc2ZjIzCTNVUUJCMTc5MDg1MDcyNTk%3D,1]
[6.0.4/129,47]
[20.2,12]
[30.0,256]
[CQk2OTVjYjc4OTljOGJkNjg0CUVBNFNGSUFZUE5CTVpMT0Y%3D,1]
[42.0,323521]
[20.1.0,119]
[998.0.mm.998,2]
[30.1,80998]
[6.8.4.1305,2124]
[5.5.2/114,3]
[4.1.3,2]
[CQljZTc0MmVhZWU2YTc1ODYJUEJWMDIxNkExMDAwMDU4MQ%3D%3D,1]
[5.2.2,184]
[6.9.3/149,77112]
[5.0.1,49]
[19.0,40]
[40.1,56107]
[22.3,35488]
[46.1,10224535]
[30.2.0,27]
[32.0,40524]
[CQliZDEwZWU2Y2VmOTc1MGI2CUI3RURVMTc2MjgwMDc3MDI%3D,1]
[4.6.0,17]
[33.0,32698]
[19.2,10]
[news_lite_xiaomi,1]
[27.0.0,296]
[43.0,1075801]
[CQljNDIyZDRkZDhhMmFmYzYwCTU4ZjhjZTEy,2]
[QQ_news_yunying3,2]
[CQlhOTY4NjY5MWFkNWZmZmExCU1HWDVUMTc3MTQwMDE3MDc%3D,4]
[6.4.1/134,621]
[35.1.0,382]
[6.5.3/138,825]
[3.8.3,62]
[CQk5NzAzYmU3ZDZiZWMyYzIJYWEzOWRlNjk%3D,1]
[6.7.1.1276,3982]
[23.2,35966]
[6.6.1/142,2401]
[24.3,7899]
[5.6.2.1071,394]
[5.7.2/124,70]
[6.8.1/145,37623]
[31.1,10]
[6.6.1.1260,3453]
[26.2,14530]
[6.2.1/132,1877]
[6.3.1/133,709]
[5.5.4,643]
[5.7.1.1077,367]
[5.5.3/115,248]
[CQlmODE5OTM0MjQyNGEyNDA4CUNCNTEyQlVLUzc%3D,1]
[6.9.2/148,1911]
[5.4.0,303]
[34.2,71627]
[5.5.2,4377]
[4.4.0,16]
[24.2,8236]
[37.0,47449]
[1.4,2]
[5.7.2.1084,121]
[5.4.8,17093]
[6.5.1.1202,618]
location
[null,1085]
[,53793385]
size
[32,1186404]
[31,1188758]
[115,1176]
[null,1085]
[28,759]
[304,136000]
[34,1184451]
[125,371]
[26,6797]
[118,809]
[25,1740]
[40,91290]
[41,47079]
[75,8529649]
[116,1263]
[11,348841]
[29,184]
[131,797495]
[22,35863]
[50,8206151]
[2,831705]
[117,898]
[136,162]
[110,2631]
[23,13162]
[39,91336]
[1,2081822]
[301,75060]
[300,7267]
[3,1098307]
[53,13]
[27,554611]
[120,1098]
[130,427]
[24,4946]
[52,1]
[114,1635]
[12,239619]
[127,276]
[132,261]
[60,4208]
[135,139]
[112,1395]
[37,1011000]
[202,82]
[5,19]
[200,24]
[30,204]
[54,14]
[129,257]
[133,225]
[36,1025999]
[4,14303235]
[119,692]
[35,1129918]
[113,1897]
[123,557]
[137,106]
[111,1716]
[33,1204930]
[122,670]
[20,7398927]
[121,691]
[201,3009]
[128,264]
[138,114]
[126,463]
[134,176]
[139,101]
[21,10753]
[38,920776]
[124,506]
[51,1]
Filter stat join query count is 53794470
All process is finish !
