argument: key(conf), value(/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/)
argument: key(sDt), value(2018-10-16)
argument: key(eDt), value(2018-10-16)
SparkBatch init() configDir=/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/
Initializing spark component...
Loading spark_component component config from /home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/spark.conf
Initializing new spark context with name Rank_rank_query_osappv_algo...
Use KryoSerializer conf
This app use spark sql
ModelBatchComponent init() configDir=/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/
Initializing model component ... 
Loading model_component component config from /home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/model.conf
Starting...
The App start to run.
INFO: fetch files from path /datastream/algo/rankserver/log/server/2018-10-16/*
sbc rddcontext info serverLogRDD
Finish set hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-16/ad_pangu_rankserver_server_20181016-000000549+0800.15046563744396832.00000350-1106072449--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-16/ad_pangu_rankserver_server_20181016-000000549+0800.15046563744396832.00000350-1106072449--1193959466.lzo.index,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-16/ad_pangu_rankserver_server_20181016-000000579+0800.15599355846587960.00000258-2141786716--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-16/ad_pangu_rankserver_server_20181016-000000579+0800.15599355846587960.00000258-2141786716--1193959466.lzo.index,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-16/ad_pangu_rankserver_server_20181016-000000611+0800.15046551900574094.00000312-1235155168--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-16/ad_pangu_rankserver_server_20181016-000000611+0800.15046551900574094.00000312-1235155168--1193959466.lzo.index,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-16/ad_pangu_rankserver_server_20181016-000000640+0800.51360504495896758.00000725-1270392737--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-16/ad_pangu_rankserver_server_20181016-000000640+0800.51360504495896758.00000725-1270392737--1193959466.lzo.index,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-16/ad_pangu_rankserver_server_20181016-000000688+0800.50162700053868216.00000334-2044889051--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-16/ad_pangu_rankserver_server_20181016-000000688+0800.50162700053868216.00000334-2044889051--1193959466.lzo.index to serverLogRDD RDD with lzo format
root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- exp_ids: string (nullable = true)
 |-- location_count: integer (nullable = false)
 |-- diversity_type: string (nullable = true)
 |-- latency: long (nullable = false)
 |-- request_time: long (nullable = false)
 |-- response_time: long (nullable = false)
 |-- total_ids_count: integer (nullable = false)
 |-- unique_ids_count: integer (nullable = false)
 |-- truncate_flag: string (nullable = true)
 |-- truncate_account: string (nullable = true)
 |-- truncate_plan: string (nullable = true)
 |-- exp_layers: string (nullable = true)
 |-- processors: string (nullable = true)
 |-- process_time: map (nullable = true)
 |    |-- key: string
 |    |-- value: integer (valueContainsNull = false)
 |-- ad_num: integer (nullable = false)
 |-- parse: integer (nullable = false)
 |-- make: integer (nullable = false)
 |-- ext: map (nullable = true)
 |    |-- key: string
 |    |-- value: string (valueContainsNull = true)
 |-- host: string (nullable = true)
 |-- time: long (nullable = false)

root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- request_time: string (nullable = true)
 |-- os: string (nullable = true)
 |-- appv: string (nullable = true)

[null,7660]
[2,31681025]
[1,29913318]
[3,17123651]
[5,547513]
[28.1,38892]
[5.3.0,3906]
[5.1.2,7]
[3.3.4,10]
[6.5.7.1250,424]
[CQk4NTVkY2YwZmZkYzNjNjg3CUFHWTdOMTg3MjkwMDY4OTY%3D,2]
[34.5,5193]
[41.0,668557]
[null,7660]
[6.0.5.1120,96]
[5.5.3,3]
[5.1.6,67]
[4.3.0,6]
[21.0,4275]
[19.4,5]
[6.1.1.1143,23]
[40.0,547843]
[CQk1NjE5OGI2MDI1YjM4YzI5CTY4VTVUMTdCMjQwMDEyODQ%3D,1]
[9.9.9,1]
[3.8.6,113]
[CQk1MzY1ZWE1ZGI0M2RmNTRjCTVFRjAyMTdCMjEwMDc3OTg%3D,3]
[3.8.7,12566]
[5.6.1.1062,88]
[4.1.5,7]
[3.5,30]
[5.5.0,1643]
[5.5.3.1050,105]
[CQk4YjIyZTQyNmJmYzc2YWRmCVVZVDdOMTdBMTIwMTE5Njk%3D,2]
[6.9.1/147,41]
[35.0,7703]
[5.4.3,11050]
[5.4.4,709]
[5.1.5,59]
[0.0.0,79367]
[34.1.1,74343]
[CQk1YTJhYjM0ZWRhZTc5NDczCTUwYzVhYTVm,4]
[5.4.5,932]
[5.4.7,5737]
[20.0,1071]
[29.1,323538]
[3.6,62]
[samsung_store_news,6]
[37.2,592695]
[CQk4NTkyMjAxODRiNDYwODZhCUZBN0IxMTcwMDgyOQ%3D%3D,1]
[CQkzNGE2M2Y0OGZmMzY3NmQ5CTNIWDdOMTcyMTcwMDQzMTg%3D,7]
[3.8.2,98]
[24.0,22024]
[3.7,32]
[22.2,50]
[CQlmOWUwYjk1MjJmYTBlNTliCUtWWEJCMTdCMDkyMDc3MzE%3D,88]
[CQk1NDIzOGVlZTkzMGU3ODZkCTU0TDlYMTg0MTNXMTc0NTc%3D,1]
[6.7.1/143,458]
[31.0,253832]
[6.6.8.8,764]
[4.0.3,13]
[CQliYWUxMjBlZDI1MTMxNDE4CTkwODk1YjJm,8]
[30.1.0,29]
[,368711]
[5.0.4,4]
[6.5.8/141,64]
[20.1,5775]
[38.0,497683]
[5.0.6,110]
[5.5.2.1041,147]
[35.1,496220]
[6.5.2/137,51]
[5.1.1,13]
[3.7.1,2]
[33.1,458454]
[6.0.3.1100,186]
[6.0.6.1127,140]
[33.2.1,101221]
[6.1.2.1145,423]
[sogou_news,1]
[5.4.2,3422]
[5.1.0,7]
[4.1.1,8]
[CQljNjVkNGJhZWJmNTQwMDU3CTgzZDcxYTJi,1]
[CQk0ZDBkZGYxNDM1YmJmNWUwCTNIWDAyMTcxMDUwMDM3MDg%3D,2]
[6.8.3.1303,2573]
[4.5.0,26]
[23.0,24186]
[6.0.1/126,2]
[3.8.0,140]
[huawei_news,6]
[5.0.5,16]
[39.0,247341]
[33.3,6389]
[6.0.2/127,29]
[4.0.2,1]
[9.9.9.9,2]
[5.4.6,143]
[22.0,13271]
[6.8.3/146,766]
[24.1,51500]
[6.3.1.1177,928]
[CQkzZGY2YWQ3NjcwMWU4ODFmCTNIWDdOMTZCMTYwMDMxMDY%3D,2]
[6.5.1/136,2]
[28.2,221500]
[CQk3NTM0MWY3M2NmNjFkYmIyCTNhZmNkZDk4,4]
[33.2,608545]
[19.3,2]
[26.1,121298]
[6.8.1/144,8]
[43.1,8712598]
[5.0.2,52]
[44.0,19233022]
[3.8.5,733]
[5.2.7,843]
[23.1,20296]
[31.2,73057]
[5.2.1,42]
[3.8.4,32]
[39.1,211963]
[1.0,28003099]
[45.0,492793]
[4.1.6,22]
[5.5.1,9207]
[6.9.1.1314,42200]
[28.0,69609]
[37.1,96983]
[CQk0MmRiNzhjZDE0MDg3NDNiCTNVUUJCMTc4MTg1MTE0NDE%3D,1]
[29.1.0,1793]
[3.2,70]
[41.0.0,9902]
[6.0.5/130,30]
[5.2.5,546]
[CQlhYTEyY2I0YWNkNzY4NThhCVNKRUdMMTgyMDEwMDAwNDU%3D,2]
[25.0.0,70]
[36.0,236005]
[25.1,26281]
[5.2.0,25]
[33.3.0,74]
[46.0,264]
[22.1,62375]
[5.1.3,91]
[34.1,45132]
[28.2.0,472]
[25.1.0,1029]
[3.8.1,194]
[5.2.6,86]
[CQk4OTM5YmNjODBjNTQyOTU0CTRlYjZjMmFh,1]
[21.1,19]
[6.8.1.1292,1265]
[4.2.0,1]
[6.2.1.1162,339]
[32.1,95132]
[6.5.7/140,13]
[6.5.4/139,2]
[6.0.3/128,5]
[5.7.3.1086,467]
[26.1.0,5]
[5.2.9,1569]
[27.0,122100]
[4.1.4,4]
[47.0,24]
[6.1.1/131,69]
[CQlmNTk0OWUzN2IwNmNiYzgxCVdZRU5XMTc5MzAwMDUzMjk%3D,10]
[5.2.8,1181]
[34.0,277997]
[6.4.1.1188,620]
[5.2.3,151]
[19.1,13]
[5.4.1,3401]
[CQk2OTI1OGI0Y2RkYzNkNDJjCTRmMjQ1YjIx,1]
[5.0.0,16]
[26.2.0,455]
[5.7.3/125,67]
[CQlmYjNhOGFiY2Q2NTQ5MmY4CWIzMTVlMmFi,1]
[25.0,92275]
[6.5.3.1210,751]
[3.3.0,2]
[29.0,12955]
[28.1.0,586]
[CQkyOTdlOTIyMDE1NTU2ZDMzCTEyMzM5NmJh,1]
[4.1.2,9]
[26.0,7295]
[CQk0ZTBiMGU1MGJjZTBkZWY5CTlITkJCMTdBMjQyMTA3NDY%3D,3]
[4.6.1,5]
[4.0.1,2]
[6.0.4/129,12]
[CQkxMGZlZjA3NmUxNjc4YTE2CUxFNjdBMDYxNzAyNzkxNzA%3D,1]
[20.2,10]
[30.0,698]
[42.0,951913]
[CQlkZTU4NjRlNzUyNjNlMzcwCTRZWURVMTc0MjAwMTY2MTI%3D,1]
[20.1.0,63]
[CQkxODRhMDIwZTI1ZjA0MTEzCTFlYTEzMDk4MDMwNA%3D%3D,1]
[30.1,189783]
[6.8.4.1305,1162]
[4.1.3,3]
[CQlmYmU2MDkxMzM0N2EzZTQ3CVFEWU5XMTc1MTcwMTAyMjk%3D,3]
[5.2.2,322]
[6.9.3/149,13781]
[CQlmOThjMjIzNTk3OGUyYWU1CThGUzVUMTY5MTIwMDE3NDk%3D,2]
[5.0.1,56]
[19.0,24]
[CQk0NDJhOGQxYzMzMjY1MjhkCTRhMDlkMDEyOTkwNA%3D%3D,3]
[40.1,150752]
[22.3,74437]
[30.2.0,82]
[32.0,78202]
[4.6.0,37]
[33.0,84837]
[19.2,9]
[27.0.0,440]
[43.0,13329515]
[CQk3YTU0OTcwODVhYjAyNjlhCTROVDRDMTc2MjcwMDQxNzk%3D,16]
[6.4.1/134,137]
[35.1.0,1080]
[6.5.3/138,233]
[CQkzODkwZGI2MjlmNTE2NWJmCVA3QzAyMTdDMTMwMDA4MTY%3D,2]
[3.8.3,89]
[6.7.1.1276,1524]
[CQlmZGNmMGM3MDIzNzQ2ZjhlCUtWWEJCMTdCMDkyMDEyNDA%3D,1]
[23.2,80680]
[6.6.1/142,649]
[CQliOTQ5MWFhNThiODJkNGQyCUhNS05XMTdCMjQwMDI1MDk%3D,2]
[24.3,18988]
[5.6.2.1071,115]
[CQljMzFhMWZmYzMwMjhkNTA5CTU2ZDc2MzBl,5]
[CQljMDQ3OWEwMDA3Y2Q3MDFjCTRjZDNkMzM1,1]
[5.7.2/124,14]
[6.8.1/145,7914]
[31.1,11]
[6.6.1.1260,1201]
[26.2,33260]
[CQk0MjIwYjUxNmQzNzg5YjYyCTMzZjVlOTdkMDcwNA%3D%3D,3]
[6.2.1/132,441]
[6.3.1/133,157]
[CQllZDcyNjY3NmE0MmJlOWQJV1lFNEMxN0IyNTAwNjAzNQ%3D%3D,1]
[CQk3MTBiZDgxMzA4Mzg4ZjQyCTRkYTkzZTdk,1]
[5.7.1.1077,147]
[CQk2OWM0ZDkxMGU4MzdkMDBhCTU0TDlYMTg4MDdXMTI5Mjk%3D,1]
[CQkxYjYzMWI1YWE4Y2YyY2U0CTNETjRDMTZCMTUwMDIwNjE%3D,2]
[5.5.3/115,70]
[6.9.2/148,1406]
[5.4.0,585]
[CQlmNGNjMWRhNDVjN2M5YTIJV1RLN04xNkMxNjAwMTU0Mg%3D%3D,16]
[5.5.2,65215]
[34.2,166112]
[CQlkYTU5YjNkM2U1NmFmYzNlCWQzN2MwZTI%3D,4]
[4.4.0,20]
[24.2,16036]
[37.0,103956]
[CQk1MTZkMzFkYWE5N2Q4N2QyCWJlOTI0ZmI5,2]
[5.7.2.1084,33]
[3.3.2,4]
[5.4.8,29270]
[6.5.1.1202,234]
Filter stat join query count is 79273167
All process is finish !
argument: key(conf), value(/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/)
argument: key(sDt), value(2018-10-17)
argument: key(eDt), value(2018-10-17)
SparkBatch init() configDir=/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/
Initializing spark component...
Loading spark_component component config from /home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/spark.conf
Initializing new spark context with name Rank_rank_query_osappv_algo...
Use KryoSerializer conf
This app use spark sql
ModelBatchComponent init() configDir=/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/
Initializing model component ... 
Loading model_component component config from /home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/model.conf
Starting...
The App start to run.
INFO: fetch files from path /datastream/algo/rankserver/log/server/2018-10-17/*
sbc rddcontext info serverLogRDD
Finish set hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-17/ad_pangu_rankserver_server_20181017-000000195+0800.51446896768433949.00000725-1270392737--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-17/ad_pangu_rankserver_server_20181017-000000195+0800.51446896768433949.00000725-1270392737--1193959466.lzo.index,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-17/ad_pangu_rankserver_server_20181017-000000200+0800.71489334537185437.00000373-1692878463--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-17/ad_pangu_rankserver_server_20181017-000000200+0800.71489334537185437.00000373-1692878463--1193959466.lzo.index,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-17/ad_pangu_rankserver_server_20181017-000000377+0800.50249095246171467.00000385-1915806332--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-17/ad_pangu_rankserver_server_20181017-000000377+0800.50249095246171467.00000385-1915806332--1193959466.lzo.index,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-17/ad_pangu_rankserver_server_20181017-000000507+0800.15132956741636161.00000350-1106072449--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-17/ad_pangu_rankserver_server_20181017-000000507+0800.15132956741636161.00000350-1106072449--1193959466.lzo.index,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-17/ad_pangu_rankserver_server_20181017-000000616+0800.51447397147948641.00000380-1399475456--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-17/ad_pangu_rankserver_server_20181017-000000616+0800.51447397147948641.00000380-1399475456--1193959466.lzo.index to serverLogRDD RDD with lzo format
root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- exp_ids: string (nullable = true)
 |-- location_count: integer (nullable = false)
 |-- diversity_type: string (nullable = true)
 |-- latency: long (nullable = false)
 |-- request_time: long (nullable = false)
 |-- response_time: long (nullable = false)
 |-- total_ids_count: integer (nullable = false)
 |-- unique_ids_count: integer (nullable = false)
 |-- truncate_flag: string (nullable = true)
 |-- truncate_account: string (nullable = true)
 |-- truncate_plan: string (nullable = true)
 |-- exp_layers: string (nullable = true)
 |-- processors: string (nullable = true)
 |-- process_time: map (nullable = true)
 |    |-- key: string
 |    |-- value: integer (valueContainsNull = false)
 |-- ad_num: integer (nullable = false)
 |-- parse: integer (nullable = false)
 |-- make: integer (nullable = false)
 |-- ext: map (nullable = true)
 |    |-- key: string
 |    |-- value: string (valueContainsNull = true)
 |-- host: string (nullable = true)
 |-- time: long (nullable = false)

root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- request_time: string (nullable = true)
 |-- os: string (nullable = true)
 |-- appv: string (nullable = true)

[null,60680]
[2,57954965]
[1,43301716]
[3,13605623]
[5,459864]
[28.1,69189]
[5.3.0,3711]
[5.1.2,15]
[3.3.4,4]
[6.5.7.1250,449]
[3.2.9,2]
[34.5,9295]
[41.0,1229669]
[CQk5ZDU3MjA5MDdjMDhkZjAyCVpZMjIzWDZDM0Q%3D,2]
[6.0.5.1120,93]
[null,60680]
[5.5.3,2]
[5.1.6,70]
[4.3.0,3]
[21.0,6095]
[CQk4ZTc4NWJkNDAxNmMwNDVjCThERjZSMTY5MjQwMDIwMDM%3D,7]
[19.4,11]
[6.1.1.1143,21]
[CQkzNDEwM2QzMjRhMzUzMGI1CUtWWEJCMTdDMTUyMDc5MjE%3D,1]
[40.0,1063354]
[3.2.8,2]
[9.9.9,2]
[3.8.6,82]
[CQk1NGQxMTE2MTZiYTdjYwlLVlhCQjE3QTMxMjM2OTA0,2]
[CQljN2E1YjFiOWZiYzQzOTJmCUhNS05XMTc5MjYwMzA1NjA%3D,27]
[3.8.7,13600]
[5.6.1.1062,79]
[4.1.5,9]
[3.5,19]
[5.5.0,1513]
[5.5.3.1050,97]
[6.9.1/147,45]
[35.0,15210]
[5.4.3,10567]
[5.4.4,625]
[5.1.5,51]
[0.0.0,77032]
[34.1.1,122788]
[CQk2Nzk1MGUxYTI5MjY0MDY3CVNKRTAyMTgxMTAwMDY1ODI%3D,1]
[5.4.5,856]
[5.4.7,5659]
[20.0,1516]
[29.1,607093]
[3.6,64]
[samsung_store_news,2]
[37.2,1137080]
[CQk4NTkyMjAxODRiNDYwODZhCUZBN0IxMTcwMDgyOQ%3D%3D,4]
[3.8.2,102]
[24.0,46588]
[3.7,26]
[22.2,101]
[6.7.1/143,582]
[31.0,464376]
[6.6.8.8,753]
[4.0.3,10]
[CQk0NjAxOGU5MmM2MjM4YWQ2CTEzNzNiMmI3,39]
[CQkxN2QzZjFiYTYzZGIzYTcwCTVFRjdOMTdCMjMwMDk4MzE%3D,2]
[30.1.0,6]
[,366129]
[5.0.4,8]
[CQlmYzIzN2E4YzZlYzRmYjhhCTFmMjFiOGM5MWY1YzM%3D,4]
[6.5.8/141,95]
[20.1,8081]
[38.0,931663]
[5.0.6,74]
[5.5.2.1041,125]
[35.1,1028389]
[6.5.2/137,65]
[CQkzMDM1NzUzYTM1ZWRlYTc1CThSWUJCMTgyMTE1MTYzMTc%3D,1]
[5.1.1,13]
[3.7.1,4]
[33.1,1030888]
[CQlmNGI0NzdhODRiZmVmOGQ2CTNkZmM2MzA2,21]
[6.0.3.1100,141]
[CQlhMzYzZTk0YjdmODhmNDgyCUpKUjdOMTczMTAwMDIwMzY%3D,2]
[6.0.6.1127,136]
[33.2.1,163312]
[6.1.2.1145,412]
[360_news,1]
[5.4.2,3338]
[5.1.0,13]
[CQkzOTc1YTc4YzU0NjgzNzdiCTQ1Y2EzMWYz,2]
[4.1.1,6]
[CQk2YWMwZDIxMTllNGYwNGExCTMzZTA1NWIw,1]
[6.8.3.1303,2436]
[CQlhNjkxMjI0ZjUwMjE4N2RkCTk4MWE2ZTM1,2]
[4.5.0,15]
[23.0,43690]
[6.0.1/126,1]
[huawei_news,38]
[3.8.0,118]
[5.0.5,16]
[33.3,12474]
[39.0,513936]
[CQliNjM3MDI2NGUzOTBmNzE2CWY0MTVjNTY1,5]
[CQk4YzYzOWFkOTRmYzQ3ZTk1CUNKTDdOMTYyMDIwMDEzMDg%3D,1]
[6.0.2/127,43]
[4.0.2,6]
[9.9.9.9,1]
[5.4.6,164]
[CQk0MDYxYTA3MDk5NmE4YzBjCTYzODRkYWY4,6]
[22.0,18769]
[6.8.3/146,1040]
[CQlkMjc3MmIxMjdhYTE3YWEzCTE5ZDBkY2Ri,4]
[24.1,73393]
[99.9,7]
[6.3.1.1177,879]
[6.5.1/136,9]
[CQllNjM1OTk3OGY3NDU0YzBiCUJURjRDMTczMTQwMDgxNTA%3D,1]
[CQk1MGZkNThkZmVlYzMwOTg3CTMyZWY0NDQw,3]
[28.2,404324]
[33.2,796330]
[26.1,230569]
[6.8.1/144,19]
[43.1,24734294]
[5.0.2,42]
[44.0,29686026]
[3.8.5,578]
[5.2.7,726]
[23.1,33829]
[31.2,140895]
[5.2.1,38]
[3.8.4,35]
[39.1,335705]
[1.0,23472649]
[45.0,1313607]
[4.1.6,10]
[CQkzMmVkM2YyMmYwYjU3NzM2CUtWWEJCMTdDMjg1MDYxMzU%3D,1]
[5.5.1,8419]
[6.9.1.1314,40653]
[CQkxNDdlNTczNGQzM2E5MmM0CVBCVjAyMTZBMjgwMDU4NzE%3D,1]
[28.0,137736]
[37.1,198573]
[29.1.0,3031]
[3.2,181]
[41.0.0,11065]
[6.0.5/130,42]
[CQk1MDJhZjg2NTY2NTQzY2E0CTJmNGI0ZTE1,5]
[5.2.5,520]
[25.0.0,58]
[36.0,468675]
[25.1,32124]
[5.2.0,17]
[33.3.0,130]
[46.0,485]
[22.1,87775]
[5.1.3,110]
[CQk3YmRlNmE4MzI5NjQwOGRiCTNVUUJCMTc3MTU1MTc5NTI%3D,2]
[34.1,79502]
[28.2.0,801]
[25.1.0,1216]
[3.8.1,206]
[5.2.6,63]
[CQllYTRlMjVkYjllYTcwYTE3CUJURjRDMTcyMTEwMDQxMDQ%3D,8]
[21.1,24]
[CQk1ZmVhNmE5ZDJhMzEzOWIwCVNKRTdOMTc2MDgwMDI3NTg%3D,14]
[6.8.1.1292,1264]
[CQljMThhZjQ0ZjRmNDY0YzVjCTNGWEJCMTg2MDcyMDEzNTg%3D,3]
[CQk4YzExZjkxYjIxMjc1Yjk5CTU3MWYzYWQ%3D,16]
[4.2.0,7]
[6.2.1.1162,336]
[32.1,156359]
[6.5.7/140,18]
[6.5.4/139,3]
[6.0.3/128,12]
[5.7.3.1086,440]
[26.1.0,11]
[CQk2NmM5MzVhMDYwMTY2ODUxCU1ZVjAyMTU4MTgwMTg3NzA%3D,1]
[5.2.9,1501]
[27.0,222524]
[4.1.4,1]
[47.0,81]
[6.1.1/131,99]
[5.2.8,1056]
[34.0,636824]
[6.4.1.1188,575]
[5.2.3,141]
[19.1,27]
[CQk1NjU4MmY1M2JkZjY1ODJkCTU2NTdjNTM5,6]
[5.4.1,3162]
[CQk5ZGY4OTJjYTZmNzQxNTVkCVFEWTRDMTdBMTAwMDY1Nzc%3D,2]
[CQkyMDBjMGFmZjkxYjhiZjY3CUI3RTVUMTc1MjUwMDU1MzA%3D,1]
[5.0.0,7]
[3.8,1]
[26.2.0,447]
[5.7.3/125,92]
[CQllYmI4OWQ1YmQ3NDEzNmVmCUtWWEJCMTdBMTk1MTM4Mzg%3D,1]
[CQk4NDJmZjkzOGNlZDc0NmZkCTcxMDAwYjk%3D,35]
[25.0,173817]
[6.5.3.1210,748]
[CQllODZlMmM3Nzg0NTcxNWIwCWM3ZThjNjU5,13]
[CQk1NzBkNjg0YjE1YjcyNjdhCTM3N2MxZWNj,13]
[29.0,23606]
[28.1.0,686]
[4.1.2,2]
[26.0,15059]
[33.2.2,4]
[lite_bdzbl_sem_ts,3]
[4.6.1,13]
[CQliYzI0YWI4OWE3ZjVmZDYzCTQxOWYzYmE4,1]
[4.0.1,4]
[CQkxYTljYjlmZDNhODdmZGQ4CTM2TEJCMTc4Mjk1MDQ2ODM%3D,8]
[6.0.4/129,15]
[20.2,12]
[30.0,1209]
[42.0,1759018]
[20.1.0,71]
[CQk1YWI3ZTZiZWVjYWNlN2VhCWU5NzMzMTky,1]
[30.1,349164]
[6.8.4.1305,1072]
[5.5.2/114,2]
[4.1.3,2]
[CQlmYmU2MDkxMzM0N2EzZTQ3CVFEWU5XMTc1MTcwMTAyMjk%3D,9]
[5.2.2,306]
[6.9.3/149,19672]
[5.0.1,46]
[19.0,28]
[CQkxODU0NjQwZGY0ODYzMTgwCTY4VURVMTdCMTEwMTQzNzk%3D,1]
[40.1,241514]
[22.3,108270]
[30.2.0,81]
[32.0,177968]
[CQkyZmIyN2RlMWJlZGE5OWRhCVJKQ0RVMTdCMDkwMDAwNzM%3D,2]
[4.6.0,30]
[33.0,183803]
[19.2,14]
[27.0.0,638]
[43.0,19100805]
[6.4.1/134,214]
[35.1.0,1654]
[6.5.3/138,296]
[3.8.3,151]
[6.7.1.1276,1340]
[23.2,129348]
[6.6.1/142,859]
[24.3,45853]
[5.6.2.1071,109]
[CQkyOTgzZjZlZmM4N2ZhYWUwCU1EUU5XMTc0MDgwMDIzMTE%3D,8]
[CQk5NmExODA1YzE4YzRlMzdmCTEwNTM4Nzhh,1]
[5.7.2/124,21]
[6.8.1/145,11266]
[31.1,23]
[6.6.1.1260,1144]
[CQkxMWEwMzljOGMxMzUzZWY2CWM4MWRkZjgx,6]
[CQk4ZTVkMjNlYzZjNjdkZjBhCTlZSk5XMTdCMjkwMDU5OTE%3D,1]
[26.2,54688]
[6.2.1/132,659]
[6.3.1/133,220]
[CQk1MTdhYWQzZWQxOTQzODdjCVA3QzAyMTdCMjIwMDUwNDU%3D,1]
[CQljMmRmNDFlMGEwNjAwM2EzCTQ4MzZlYmU0N2Q0Mw%3D%3D,3]
[5.7.1.1077,134]
[866789026518002,1]
[5.5.3/115,99]
[6.9.2/148,1758]
[5.4.0,598]
[CQkyYTM5OTE0N2ExMmRkMmFkCTVlOWY2ODA%3D,7]
[34.2,277144]
[5.5.2,62552]
[4.4.0,12]
[CQkxZDA0OTE2Mzc4ZTkzZTE1CVZMR05XMTczMjIwNzEzMjA%3D,2]
[miliao_news,8]
[24.2,38144]
[37.0,173217]
[18.0.0,1]
[5.7.2.1084,32]
[5.4.8,27924]
[6.5.1.1202,188]
[CQk3MjhlMzk4Zjk1ZjYxNjRiCUtWWEJCMTc5MTk1MTIxMDE%3D,2]
Filter stat join query count is 115382848
All process is finish !
argument: key(conf), value(/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/)
argument: key(sDt), value(2018-10-18)
argument: key(eDt), value(2018-10-18)
SparkBatch init() configDir=/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/
Initializing spark component...
Loading spark_component component config from /home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/spark.conf
Initializing new spark context with name Rank_rank_query_osappv_algo...
Use KryoSerializer conf
This app use spark sql
ModelBatchComponent init() configDir=/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/
Initializing model component ... 
Loading model_component component config from /home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/model.conf
Starting...
The App start to run.
INFO: fetch files from path /datastream/algo/rankserver/log/server/2018-10-18/*
sbc rddcontext info serverLogRDD
Finish set hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-18/ad_pangu_rankserver_server_20181018-000000036+0800.50335497315558478.00000334-2044889051--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-18/ad_pangu_rankserver_server_20181018-000000036+0800.50335497315558478.00000334-2044889051--1193959466.lzo.index,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-18/ad_pangu_rankserver_server_20181018-000000105+0800.72754175837918631.00000435-1434713025--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-18/ad_pangu_rankserver_server_20181018-000000107+0800.15772149547557193.00000258-2141786716--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-18/ad_pangu_rankserver_server_20181018-000000107+0800.15772149547557193.00000258-2141786716--1193959466.lzo.index,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-18/ad_pangu_rankserver_server_20181018-000000195+0800.71575733475462661.00000373-1692878463--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-18/ad_pangu_rankserver_server_20181018-000000195+0800.71575733475462661.00000373-1692878463--1193959466.lzo.index,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-18/ad_pangu_rankserver_server_20181018-000000435+0800.15219345559534515.00000312-1235155168--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-18/ad_pangu_rankserver_server_20181018-000000435+0800.15219345559534515.00000312-1235155168--1193959466.lzo.index,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-18/ad_pangu_rankserver_server_20181018-000000439+0800.50335496009260548.00000395-1786723613--1193959466.lzo to serverLogRDD RDD with lzo format
root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- exp_ids: string (nullable = true)
 |-- location_count: integer (nullable = false)
 |-- diversity_type: string (nullable = true)
 |-- latency: long (nullable = false)
 |-- request_time: long (nullable = false)
 |-- response_time: long (nullable = false)
 |-- total_ids_count: integer (nullable = false)
 |-- unique_ids_count: integer (nullable = false)
 |-- truncate_flag: string (nullable = true)
 |-- truncate_account: string (nullable = true)
 |-- truncate_plan: string (nullable = true)
 |-- exp_layers: string (nullable = true)
 |-- processors: string (nullable = true)
 |-- process_time: map (nullable = true)
 |    |-- key: string
 |    |-- value: integer (valueContainsNull = false)
 |-- ad_num: integer (nullable = false)
 |-- parse: integer (nullable = false)
 |-- make: integer (nullable = false)
 |-- ext: map (nullable = true)
 |    |-- key: string
 |    |-- value: string (valueContainsNull = true)
 |-- host: string (nullable = true)
 |-- time: long (nullable = false)

root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- request_time: string (nullable = true)
 |-- os: string (nullable = true)
 |-- appv: string (nullable = true)

[null,16031]
[2,66816323]
[1,53876865]
[3,35211073]
[5,828518]
[28.1,89816]
[5.3.0,4030]
[5.1.2,7]
[6.5.7.1250,407]
[34.5,10577]
[CQljMjk2NGU3YjZkMTJjZDA1CURVUE5XMTdBMjEwMTkzNDc%3D,2]
[41.0,1419118]
[null,16031]
[6.0.5.1120,76]
[5.5.3,80]
[5.1.6,75]
[4.3.0,5]
[21.0,5190]
[CQk5NTI5MDRjOTA4NWJlNmVmCUxFNjdBMDYyMTAwNDA0OTg%3D,2]
[19.4,5]
[6.1.1.1143,15]
[CQk3YWQ4ZjY2ZjE0N2VlODA5CTE1MGFkYzY0,2]
[40.0,1209249]
[CQllOWRiYjQ1ZTgxMDkyNWY1CVFEWU5XMTdCMDQwMDYwNzg%3D,2]
[3.2.8,1]
[9.9.9,2]
[3.8.6,177]
[6.4.1/10000,2]
[CQk1MzBkM2ZiM2EzNWIyYmIwCTRjZjY0ZDNjMDgwNA%3D%3D,4]
[sps_article,14]
[3.8.7,10228]
[5.6.1.1062,61]
[CQk5NmNjNzQ2Zjc3YmUyYWY4CTdkMGEyNzRj,40]
[4.1.5,20]
[3.5,50]
[5.5.0,1739]
[CQk5MmU4NzkyNDI5NzE3ZmI4CWZkM2E0MjFi,1]
[5.5.3.1050,100]
[6.9.1/147,40]
[3.3.3,9]
[CQlkODQ5N2MzMjA4MjEwZjA5CUNKTDAyMTY4MTUwMDMwNjM%3D,3]
[35.0,18007]
[5.4.3,11531]
[CQk0YmQxOGYwODAzZDQwYmIzCThCTjAyMTc2MjkwMTc2ODI%3D,1]
[5.4.4,735]
[5.1.5,60]
[0.0.0,84695]
[34.1.1,157609]
[CQk5YjZmZTcwNmE2NjhiMDMyCTRDQjVUMTdBMTEwMDA2Mjk%3D,18]
[5.4.5,915]
[5.4.7,5894]
[20.0,1277]
[29.1,752704]
[3.6,68]
[samsung_store_news,6]
[37.2,1308693]
[CQliNGRmMmM4YTBkZTAwYjBjCU1LSk5XMTg0MTgwMDkwNjI%3D,12]
[3.8.2,107]
[24.0,48972]
[3.7,38]
[22.2,142]
[CQljMjQyYjE0MGUxYWYxODgxCTRZWTRDMTdBMjQwMDA1OTg%3D,7]
[6.7.1/143,545]
[31.0,580509]
[6.6.8.8,874]
[CQkzMWQ3MzI4MTJlNzllNjExCVlUUU5XMTczMjIwMTA4NDE%3D,6]
[4.0.3,16]
[30.1.0,37]
[,319862]
[5.0.4,6]
[6.5.8/141,75]
[20.1,6956]
[CQkzN2M5NzM1YjcyOTk2NmZmCUI3RTVUMTc2MDMwMDgxMDU%3D,15]
[38.0,1085001]
[5.0.6,102]
[5.5.2.1041,129]
[35.1,1205686]
[6.5.2/137,66]
[5.1.1,7]
[CQk4ZDhlNmQ2ZjFmNDRlNGJmCUNTWDAyMTc4MTUwMDQ5MjE%3D,5]
[33.1,1144579]
[6.0.3.1100,159]
[6.0.6.1127,138]
[33.2.1,199501]
[CQkxYWUwOTU4NjQwNjU0MTU0CTU0TDlYMTgzMjVXMDg3MjQ%3D,3]
[6.1.2.1145,335]
[5.4.2,3617]
[5.1.0,15]
[CQk1OTAxM2MzMTdhYjQyN2M0CTkxMDE5MmNl,1]
[4.1.1,8]
[6.8.3.1303,1962]
[QQ_news_CPD1,4]
[4.5.0,27]
[23.0,53508]
[6.0.1/126,2]
[CQk0ZTJhMmVhM2MwNjc2OGVmCWM3ODJhODVi,3]
[3.8.0,142]
[huawei_news,10]
[5.0.5,17]
[39.0,610916]
[33.3,14666]
[CQkzZDQ5MGYxNWJkNjAzOTJkCVNKRTAyMTc4MjEwMDA0MTQ%3D,1]
[6.0.2/127,38]
[4.0.2,5]
[9.9.9.9,5]
[5.4.6,158]
[22.0,26826]
[6.8.3/146,896]
[CQk2YmNmYWExMzBlOGNiMWE1CVBCVjdOMTY5MDIwMTQwNzc%3D,2]
[24.1,68815]
[6.3.1.1177,763]
[6.5.1/136,8]
[28.2,506023]
[CQkyNjkwZTdmZThhYzIyZjAyCUNLTDRDMTZDMTAwMDU0Njc%3D,19]
[33.2,945351]
[lite_liebao_baichuan14,1]
[26.1,279771]
[6.8.1/144,14]
[863713034329544,1]
[43.1,36666945]
[5.0.2,57]
[CQlmY2ZhNjI3NTc2MmMwMGQwCUxNWDRDMTgxMDQwMDA3Mzc%3D,1]
[CQk4YmZlZmNjMGYwZjMzMTE5CUhNS05XMTc5MjYwMDkxOTM%3D,9]
[3.3,9]
[44.0,34822278]
[3.8.5,614]
[5.2.7,806]
[23.1,38404]
[31.2,171762]
[3.8.4,16]
[5.2.1,44]
[39.1,422829]
[1.0,47577390]
[45.0,4443790]
[CQk5OTQ5ZDU2MmJjYWYwYjQ4CUtWWEJCMTc2Mjg1NDkyMjQ%3D,4]
[4.1.6,9]
[5.5.1,9176]
[CQk2MmEzOWMwYWE1ZjNmYTU3CTM0NzUwNjg%3D,1]
[6.9.1.1314,37178]
[CQlhYjA1ZDRmYTc3NWMxOTZkCVM5QjdOMTdCMTQwMTE2OTc%3D,3]
[28.0,162282]
[37.1,223962]
[29.1.0,4414]
[3.2,198]
[41.0.0,13686]
[6.0.5/130,39]
[5.2.5,500]
[CQk2M2U1YmNiMGY2N2IzNmIyCTczRUJCMTg2MTEyNzk5NDk%3D,1]
[25.0.0,46]
[36.0,558936]
[25.1,28493]
[5.2.0,15]
[33.3.0,158]
[46.0,909]
[CQk4NzQ3N2YwOTNmNWY0MzNmCVE0N1RCUThIS1ZKTks3Tk4%3D,1]
[22.1,124305]
[CQk5OTdkOTQ5NDhjM2QyNDVkCTUyNzI4ZTZk,21]
[5.1.3,145]
[34.1,101125]
[28.2.0,1061]
[25.1.0,1018]
[3.8.1,264]
[5.2.6,66]
[CQlkZjY1NzYwNWVkZGVjNzVhCU1HWDVUMTc2MDUwMDEyMTk%3D,8]
[21.1,20]
[CQliNGFiM2NjNTliY2MwNTcyCWVkODljYzJl,14]
[CQk3ODc4Y2I1ZDEyNzVhNGM3CUhNSzdOMTc1MDIwMDIwMTE%3D,12]
[6.8.1.1292,1075]
[CQllYjNhNGEyZTFiOGZmNmYyCUtWWEJCMTc5MjIyMDExMjA%3D,7]
[4.2.0,10]
[6.2.1.1162,326]
[32.1,209739]
[6.5.4/139,4]
[6.5.7/140,14]
[6.0.3/128,8]
[5.7.3.1086,404]
[CQk2NTFkMmVkYjkyMzZhYzRlCWY0ZmNhOGY5,4]
[26.1.0,31]
[5.2.9,1510]
[27.0,285638]
[CQkxNGUzMjQ2Y2NjYjE5YzBlCTZkMWViNmZj,8]
[47.0,129]
[6.1.1/131,119]
[CQkzMDRkZTZmNjk1YjY5MDExCThGUzdOMTcxMDYwMDM4MjU%3D,2]
[CQk5YjRkMTk1ODQwODQ4NGE3CTM5SzlYMTg2MTVHMDczMzk%3D,1]
[5.2.8,1262]
[CQkzZmE0ODA5YTY1MTUyNTRmCVA0TTAyMTU3MDIwMDExNDI%3D,2]
[CQk1MjZhYzk2Mjk0YWI4MDcwCUI3RTVUMTc2MjIwMjM1NDU%3D,2]
[34.0,704366]
[6.4.1.1188,527]
[CQlkZDQ5ZDViNGI1ZTBkNDVjCUE3SjVUMTU2MTIwMDc3NjM%3D,4]
[5.2.3,188]
[19.1,23]
[5.4.1,3413]
[5.0.0,12]
[3.8,3]
[26.2.0,473]
[5.7.3/125,79]
[25.0,209915]
[6.5.3.1210,619]
[CQllODZlMmM3Nzg0NTcxNWIwCWM3ZThjNjU5,24]
[29.0,29953]
[28.1.0,663]
[CQliYTg1MzM2Y2VhNWJiMmFjCVdGVkJCMTg4MDExNTUxMTg%3D,1]
[CQliNWQzMDNhMDViZTNjMQlQWkhBUVNZRFM0S05TNFpT,1]
[4.1.2,6]
[26.0,17476]
[33.2.2,1]
[QQ_news_yunying2,3]
[4.6.1,13]
[4.0.1,1]
[CQlhODcwY2VhYjkwZWI4ZjU5CVdGVkJCMTg1MDg1MTY3NTg%3D,222]
[6.0.4/129,12]
[CQk4NDgwOTQyOTUwMDA2YWQ2CUtWWEJCMTgzMjY1NDU1NzM%3D,8]
[20.2,5]
[30.0,1704]
[42.0,2018922]
[CQlmMjJjODlhNDQ0ODNkYmE4CUE1UjRDMTdBMjcwMDI4OTA%3D,4]
[CQkzYTk0MDhjNGU1ZTk4YmI0CTczRUJCMTg0MjAyMTEwMzA%3D,2]
[20.1.0,76]
[30.1,433427]
[6.8.4.1305,957]
[CQk2MDM3NGU1Y2ZmNGM4NzFmCVZOM0dMTUE3NTA5MDE2MTk%3D,1]
[4.1.3,8]
[CQk3YWFlYWE5MmUyNjNkZDU2CVVXRFU3SEJJTDdFWTRTSFk%3D,1]
[5.2.2,301]
[6.9.3/149,17224]
[5.0.1,34]
[19.0,19]
[867376025796471,1]
[40.1,301307]
[22.3,154283]
[30.2.0,157]
[32.0,195799]
[4.6.0,47]
[33.0,210299]
[19.2,6]
[27.0.0,582]
[CQkyNzBlYzAyMDA3ZWRiODFhCTEyMmM3ZWIw,1]
[43.0,13297842]
[CQk4ODEzNTg2M2YyNjI2MTljCTI3UTlYMTg1MTNXMDI1NDc%3D,23]
[6.4.1/134,182]
[35.1.0,2315]
[6.5.3/138,255]
[3.8.3,47]
[6.7.1.1276,1241]
[23.2,145571]
[6.6.1/142,721]
[24.3,48708]
[5.6.2.1071,111]
[CQllMTE0ZWIxYWEzNDcxZTViCUZBN0FWMTcwMDQ3NQ%3D%3D,4]
[5.7.2/124,12]
[6.8.1/145,9248]
[CQk1ZWUwY2I1MWVhMzk2MzEJNGMzNTQyYzM%3D,3]
[31.1,52]
[6.6.1.1260,1008]
[CQllNzE5YTVjZjUwZGNlOThjCVA0TTdOMTUxMjAwMzcyMjU%3D,9]
[26.2,72735]
[6.2.1/132,535]
[6.3.1/133,199]
[CQkyYjgzMDRjMzAyZWI5ZWQwCTI3UTlYMTg1MjNXMDMxNjg%3D,1]
[5.7.1.1077,102]
[5.5.3/115,76]
[6.9.2/148,1374]
[CQk2NGY3NjY5NGVlMGM5YjkJM2Q0YTRlZDA%3D,6]
[CQkzZTRiMGM4YTUwOTM0YThjCVYzSEJCMTg2MjY1MDM3NjY%3D,10]
[5.4.0,567]
[CQkzN2ZkMzUzODIxMmYyMzRiCUpKUkRVMTZBMTMwNTM3MzY%3D,3]
[34.2,373565]
[5.5.2,70195]
[CQlmMGM3NGJmNmY0NmRmMmQ1CUZERzRDMTZDMTIwMDYwMTU%3D,2]
[4.4.0,8]
[CQk1MjBmOWM5MDAwY2JjZWZmCTI5RERVMTc0MjUwMDEyMzY%3D,5]
[news_qycx_cpa,10]
[CQkyMzlhM2I0OWM2OWJmMThhCVNRUk5XMTdCMTgwMjE4MjY%3D,1]
[netease_gw,9]
[24.2,41634]
[37.0,216095]
[5.7.2.1084,23]
[5.4.8,30761]
[6.5.1.1202,170]
[CQk1NmQ5ZjE4MmUwM2EyMzdiCWYxNjc0MDBh,2]
Filter stat join query count is 156748810
All process is finish !
argument: key(conf), value(/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/)
argument: key(sDt), value(2018-10-19)
argument: key(eDt), value(2018-10-19)
SparkBatch init() configDir=/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/
Initializing spark component...
Loading spark_component component config from /home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/spark.conf
Initializing new spark context with name Rank_rank_query_osappv_algo...
Use KryoSerializer conf
This app use spark sql
ModelBatchComponent init() configDir=/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/
Initializing model component ... 
Loading model_component component config from /home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/model.conf
Starting...
The App start to run.
INFO: fetch files from path /datastream/algo/rankserver/log/server/2018-10-19/*
sbc rddcontext info serverLogRDD
Finish set hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-19/ad_pangu_rankserver_server_20181019-000000000+0800.15305756901480708.00000350-1106072449--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-19/ad_pangu_rankserver_server_20181019-000000000+0800.15305756901480708.00000350-1106072449--1193959466.lzo.index,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-19/ad_pangu_rankserver_server_20181019-000000103+0800.72840574225611799.00000435-1434713025--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-19/ad_pangu_rankserver_server_20181019-000000103+0800.72840574225611799.00000435-1434713025--1193959466.lzo.index,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-19/ad_pangu_rankserver_server_20181019-000000104+0800.72840575504321462.00000302-1821961182--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-19/ad_pangu_rankserver_server_20181019-000000104+0800.72840575504321462.00000302-1821961182--1193959466.lzo.index,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-19/ad_pangu_rankserver_server_20181019-000000195+0800.51619696569913044.00000725-1270392737--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-19/ad_pangu_rankserver_server_20181019-000000195+0800.51619696569913044.00000725-1270392737--1193959466.lzo.index,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-19/ad_pangu_rankserver_server_20181019-000000462+0800.15858549077867247.00000271--1050773894--1193959466.lzo,hdfs://hz-cluster9/datastream/algo/rankserver/log/server/2018-10-19/ad_pangu_rankserver_server_20181019-000000462+0800.15858549077867247.00000271--1050773894--1193959466.lzo.index to serverLogRDD RDD with lzo format
root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- exp_ids: string (nullable = true)
 |-- location_count: integer (nullable = false)
 |-- diversity_type: string (nullable = true)
 |-- latency: long (nullable = false)
 |-- request_time: long (nullable = false)
 |-- response_time: long (nullable = false)
 |-- total_ids_count: integer (nullable = false)
 |-- unique_ids_count: integer (nullable = false)
 |-- truncate_flag: string (nullable = true)
 |-- truncate_account: string (nullable = true)
 |-- truncate_plan: string (nullable = true)
 |-- exp_layers: string (nullable = true)
 |-- processors: string (nullable = true)
 |-- process_time: map (nullable = true)
 |    |-- key: string
 |    |-- value: integer (valueContainsNull = false)
 |-- ad_num: integer (nullable = false)
 |-- parse: integer (nullable = false)
 |-- make: integer (nullable = false)
 |-- ext: map (nullable = true)
 |    |-- key: string
 |    |-- value: string (valueContainsNull = true)
 |-- host: string (nullable = true)
 |-- time: long (nullable = false)

root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- request_time: string (nullable = true)
 |-- os: string (nullable = true)
 |-- appv: string (nullable = true)

