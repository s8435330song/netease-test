argument: key(conf), value(/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/)
argument: key(sDt), value(2018-12-09)
argument: key(eDt), value(2018-12-09)
SparkBatch init() configDir=/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/
Initializing spark component...
Loading spark_component component config from /home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/spark.conf
Initializing new spark context with name Rank_rank_query_osappv_algo...
Use KryoSerializer conf
This app use spark sql
ModelBatchComponent init() configDir=/home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/
Initializing model component ... 
Loading model_component component config from /home/appops/songyang1/rank-netease/conf/rank_query_osappv/conf/model.conf
Starting...
The App start to run.
INFO: fetch files from path /user/algo/songyang1/serverLog/2018-12-09/*
sbc rddcontext info serverLogRDD
Finish set hdfs://hz-cluster9/user/algo/songyang1/serverLog/2018-12-09/test.lzo to serverLogRDD RDD with lzo format
root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- exp_ids: string (nullable = true)
 |-- location_count: integer (nullable = false)
 |-- diversity_type: string (nullable = true)
 |-- latency: long (nullable = false)
 |-- request_time: long (nullable = false)
 |-- response_time: long (nullable = false)
 |-- total_ids_count: integer (nullable = false)
 |-- unique_ids_count: integer (nullable = false)
 |-- truncate_flag: string (nullable = true)
 |-- truncate_account: string (nullable = true)
 |-- truncate_plan: string (nullable = true)
 |-- exp_layers: string (nullable = true)
 |-- processors: string (nullable = true)
 |-- process_time: map (nullable = true)
 |    |-- key: string
 |    |-- value: integer (valueContainsNull = false)
 |-- ad_num: integer (nullable = false)
 |-- parse: integer (nullable = false)
 |-- make: integer (nullable = false)
 |-- ext: map (nullable = true)
 |    |-- key: string
 |    |-- value: string (valueContainsNull = true)
 |-- host: string (nullable = true)
 |-- time: long (nullable = false)

root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- request_time: string (nullable = true)
 |-- os: string (nullable = true)
 |-- appv: string (nullable = true)

root
 |-- rid: string (nullable = true)
 |-- platform: string (nullable = true)
 |-- category: string (nullable = true)
 |-- exp_name: string (nullable = true)
 |-- location: string (nullable = true)
 |-- scheduling_id: string (nullable = true)
 |-- account_id: string (nullable = true)
 |-- idea_id: string (nullable = true)
 |-- idea_type: string (nullable = true)
 |-- bid: double (nullable = false)
 |-- ctr: double (nullable = false)
 |-- rank_ctr: double (nullable = false)
 |-- orig_ctr: double (nullable = false)
 |-- ecpm: double (nullable = false)
 |-- rank_ecpm: double (nullable = false)
 |-- ecpm2_idea_id: long (nullable = false)
 |-- ecpm2: double (nullable = false)
 |-- flag: integer (nullable = false)
 |-- random: double (nullable = false)
 |-- win_price: double (nullable = false)
 |-- new_win_price: double (nullable = false)
 |-- w: double (nullable = false)
 |-- pw: double (nullable = false)
 |-- lw: double (nullable = false)
 |-- factor_wp_ratio: double (nullable = false)
 |-- wp_ratio: double (nullable = false)
 |-- new_wp_ratio: double (nullable = false)
 |-- cvr: double (nullable = false)
 |-- size: integer (nullable = false)
 |-- ext: map (nullable = true)
 |    |-- key: string
 |    |-- value: string (valueContainsNull = true)
 |-- host: string (nullable = true)
 |-- time: long (nullable = false)

location********************************************
[null,107]
[1,291]
[11,47]
[114,1]
[115,1]
[12,29]
[131,141]
[2,78]
[20,141]
[22,4]
[23,1]
[3,87]
[304,3]
[31,188]
[32,194]
[33,206]
[34,196]
[35,187]
[36,164]
[37,202]
[38,161]
[39,14]
[4,1947]
[40,17]
[41,1]
[50,994]
[75,332]
1 size-average********************************************
[null,107]
[1,2269]
[2,152]
[3,120]
[4,71]
[5,78]
[6,32]
[7,29]
[8,40]
[9,35]
[10,36]
[11,28]
[12,29]
[13,15]
[14,13]
[15,16]
[16,13]
[17,24]
[18,17]
[19,33]
[20,24]
[21,12]
[22,30]
[23,31]
[24,25]
[25,26]
[26,19]
[27,20]
[28,32]
[29,22]
[30,19]
[31,21]
[32,22]
[33,28]
[34,30]
[35,26]
[36,23]
[37,20]
[38,20]
[39,20]
[40,16]
[41,17]
[42,19]
[43,14]
[44,20]
[45,22]
[46,24]
[47,21]
[48,14]
[49,17]
[50,18]
[51,19]
[52,19]
[53,16]
[54,12]
[55,11]
[56,20]
[57,16]
[58,21]
[59,23]
[60,16]
[61,22]
[62,21]
[63,24]
[64,9]
[65,19]
[66,17]
[67,20]
[68,25]
[69,21]
[70,18]
[71,26]
[72,15]
[73,12]
[74,17]
[75,14]
[76,9]
[77,20]
[78,17]
[79,26]
[80,17]
[81,16]
[82,16]
[83,14]
[84,13]
[85,10]
[86,13]
[87,14]
[88,18]
[89,16]
[90,14]
[91,18]
[92,12]
[93,21]
[94,14]
[95,17]
[96,11]
[97,11]
[98,15]
[99,10]
[100,12]
[101,8]
[102,9]
[103,16]
[104,13]
[105,7]
[106,15]
[107,8]
[108,13]
[109,5]
[110,16]
[111,11]
[112,7]
[113,7]
[114,17]
[115,8]
[116,10]
[117,9]
[118,9]
[119,12]
[120,8]
[121,12]
[122,6]
[123,14]
[124,11]
[125,11]
[126,15]
[127,20]
[128,6]
[129,13]
[130,10]
[131,13]
[132,2]
[133,16]
[134,11]
[135,16]
[136,15]
[137,12]
[138,16]
[139,10]
[140,14]
[141,11]
[142,13]
[143,7]
[144,14]
[145,7]
[146,4]
[147,15]
[148,13]
[149,9]
[150,10]
[151,19]
[152,11]
[153,8]
[154,4]
[155,5]
[156,13]
[157,10]
[158,11]
[159,7]
[160,6]
[161,4]
[162,8]
[163,7]
[164,4]
[165,10]
[166,4]
[167,7]
[168,5]
[169,7]
[170,6]
[171,9]
[172,9]
[173,7]
[174,4]
[175,3]
[176,2]
[177,9]
[178,4]
[179,9]
[180,7]
[181,9]
[182,6]
[183,5]
[184,8]
[185,4]
[186,6]
[187,1]
[188,4]
[189,4]
[190,7]
[191,5]
[192,2]
[193,4]
[194,4]
[195,5]
[196,7]
[197,4]
[198,6]
[199,2]
[200,5]
[201,6]
[202,2]
[203,3]
[204,6]
[205,3]
[207,5]
[208,1]
[209,1]
[210,6]
[211,3]
[212,4]
[213,2]
[214,5]
[215,1]
[216,3]
[217,3]
[218,4]
[219,1]
[220,3]
[221,4]
[222,3]
[223,2]
[224,4]
[226,3]
[227,6]
[228,1]
[229,2]
[230,1]
[231,3]
[232,2]
[234,4]
[235,2]
[236,2]
[237,1]
[238,1]
[239,1]
[241,2]
[242,4]
[243,3]
[244,2]
[245,2]
[246,2]
[248,5]
[249,2]
[250,3]
[251,1]
[252,1]
[253,1]
[254,2]
[255,1]
[256,2]
[258,1]
[259,4]
[260,1]
[261,1]
[262,1]
[263,4]
[264,2]
[266,2]
[267,3]
[268,4]
[269,1]
[270,3]
[271,1]
[273,2]
[274,1]
[275,1]
[276,1]
[279,1]
[280,1]
[281,1]
[282,1]
[283,1]
[284,2]
[285,2]
[286,1]
[292,1]
[293,1]
[294,1]
[296,1]
[300,3]
[303,2]
[304,3]
[306,1]
[312,1]
[314,2]
[319,2]
[336,1]
[345,1]
[349,1]
[353,1]
[356,2]
[357,1]
[369,1]
[377,1]
size-distribution********************************************
[1,47.491913986138265]
location_ount location check diff ********************************************
[2,null,null]
[2,1,52.0]
[2,101,38.95]
[2,102,40.89473684210526]
[2,2,52.0]
[2,21,79.63636363636364]
[2,22,79.63636363636364]
[2,301,63.0]
[2,302,63.0]
[2,4,83.0]
[2,50,76.0]
[2,51,93.66216216216216]
[2,52,94.29251700680273]
[2,53,41.9]
[2,54,45.80952380952381]
[3,20,14.0]
[3,200,95.0]
[3,201,95.0]
[3,202,95.0]
[3,21,9.75]
[3,22,29.8]
[3,25,110.0]
[3,28,110.0]
[3,301,82.5]
[3,302,82.5]
[3,303,82.5]
[5,null,null]
[5,1,47.76190476190476]
[5,2,52.31578947368421]
[5,3,52.10526315789474]
[5,4,54.833333333333336]
[5,5,57.64705882352941]
[6,null,null]
[6,20,36.8]
[6,21,80.26923076923077]
[6,22,79.88888888888889]
[6,23,15.222222222222221]
[6,24,74.3125]
[6,25,69.16666666666667]
[6,26,57.7]
[6,27,97.9090909090909]
[6,28,97.9090909090909]
[6,29,73.46666666666667]
[7,20,127.0]
[7,21,67.875]
[7,22,58.833333333333336]
[7,23,23.0]
[7,24,23.0]
[7,25,48.90909090909091]
[7,26,58.833333333333336]
[7,27,58.833333333333336]
[7,28,58.166666666666664]
[7,29,70.77777777777777]
[8,20,4.5]
[8,21,142.66666666666666]
[8,22,108.125]
[8,23,123.28571428571429]
[8,24,123.28571428571429]
[8,25,142.66666666666666]
[8,26,142.66666666666666]
[8,27,142.66666666666666]
[8,28,142.66666666666666]
[9,null,null]
[9,20,115.29591836734694]
[9,21,116.59016393442623]
[9,22,115.7479674796748]
[9,23,118.66115702479338]
[9,24,119.14754098360656]
[9,25,122.94067796610169]
[9,26,124.74137931034483]
[9,27,124.74137931034483]
[9,28,126.70175438596492]
[9,30,116.3157894736842]
[10,null,null]
[10,110,92.59375]
[10,111,93.5578947368421]
[10,112,94.53191489361703]
[10,113,96.43478260869566]
[10,114,98.43333333333334]
[10,115,100.8314606741573]
[10,116,100.52173913043478]
[10,117,101.66666666666667]
[10,118,103.29347826086956]
[10,119,104.26373626373626]
[10,120,82.74074074074075]
[10,121,85.84615384615384]
[10,122,89.0]
[10,123,87.46428571428571]
[10,124,90.51851851851852]
[10,125,93.65384615384616]
[10,126,93.65384615384616]
[10,127,93.65384615384616]
[10,128,96.92]
[10,129,96.92]
[10,130,111.125]
[10,131,111.125]
[10,132,111.125]
[10,133,111.125]
[10,134,111.125]
[10,135,118.66666666666667]
[10,136,118.66666666666667]
[10,137,118.66666666666667]
[10,138,131.125]
[10,139,131.125]
[10,20,133.19678714859438]
[10,21,131.57551020408164]
[10,22,133.1818181818182]
[10,23,133.4959677419355]
[10,24,134.03238866396762]
[10,25,136.12345679012347]
[10,26,136.1440329218107]
[10,27,137.73333333333332]
[10,28,138.7219917012448]
[10,29,138.7191489361702]
[10,30,102.93333333333334]
[12,200,52.25]
[12,201,52.25]
[12,202,52.25]
[12,23,101.5]
[12,24,101.5]
[12,25,101.5]
[12,26,101.5]
[12,27,101.5]
[12,28,101.5]
[12,29,27.333333333333332]
[12,30,52.25]
[12,31,52.25]
[18,null,null]
[18,1,45.1]
[18,10,55.125]
[18,11,55.125]
[18,12,55.125]
[18,13,57.0]
[18,14,57.0]
[18,15,58.68181818181818]
[18,16,62.0]
[18,17,63.578947368421055]
[18,18,67.88235294117646]
[18,2,49.77777777777778]
[18,3,51.61538461538461]
[18,4,51.5]
[18,5,50.12]
[18,6,51.61538461538461]
[18,7,55.125]
[18,8,55.125]
[18,9,55.125]
[20,20,63.142857142857146]
[20,21,63.142857142857146]
[20,22,63.4]
[20,23,63.4]
[20,24,63.4]
[20,25,63.4]
[20,26,63.4]
[20,27,63.4]
[20,28,63.4]
[20,29,63.4]
[20,70,63.4]
[20,71,63.4]
[20,72,63.4]
[20,73,63.4]
[20,74,63.4]
[20,75,63.4]
[20,76,63.4]
[20,77,63.4]
[20,78,63.4]
[20,79,63.4]
[40,110,112.11111111111111]
[40,111,112.11111111111111]
[40,112,112.11111111111111]
[40,113,112.11111111111111]
[40,114,112.11111111111111]
[40,115,112.11111111111111]
[40,116,112.11111111111111]
[40,117,112.11111111111111]
[40,118,112.11111111111111]
[40,119,121.5]
[40,120,121.5]
[40,121,121.5]
[40,122,121.5]
[40,123,121.5]
[40,124,121.5]
[40,125,121.5]
[40,126,121.5]
[40,127,112.22222222222223]
[40,128,121.5]
[40,129,121.5]
[40,130,129.57142857142858]
[40,131,141.5]
[40,132,141.5]
[40,133,151.8]
[40,134,151.8]
[40,135,151.8]
[40,136,151.8]
[40,137,163.5]
[40,138,163.5]
[40,139,163.5]
[40,20,111.44444444444444]
[40,21,112.22222222222223]
[40,22,116.875]
[40,23,112.11111111111111]
[40,24,112.11111111111111]
[40,25,112.11111111111111]
[40,26,112.11111111111111]
[40,27,112.11111111111111]
[40,28,112.11111111111111]
[40,29,112.11111111111111]
location_ount unique_ids_count average********************************************
[2,81.33161953727506]
[3,51.125]
[5,51.381443298969074]
[6,42.15945945945946]
[7,58.833333333333336]
[8,127.4074074074074]
[9,112.87045309508615]
[10,99.27619370898394]
[12,101.5]
[18,52.731898238747554]
[20,59.50397877984085]
[40,120.86774193548388]
rid unique_ids_count distribution********************************************
[1,27]
[2,26]
[3,42]
[4,37]
[5,51]
[6,18]
[7,35]
[8,133]
[9,74]
[10,94]
[11,37]
[12,56]
[13,80]
[14,69]
[15,51]
[16,53]
[17,34]
[18,76]
[19,46]
[20,68]
[21,74]
[22,109]
[23,81]
[24,108]
[25,83]
[26,56]
[27,81]
[28,138]
[29,162]
[30,65]
[31,174]
[32,141]
[33,127]
[34,72]
[35,98]
[36,61]
[37,121]
[38,114]
[39,122]
[40,65]
[41,48]
[42,103]
[43,101]
[44,82]
[45,81]
[46,85]
[47,123]
[48,110]
[49,96]
[50,88]
[51,102]
[52,62]
[53,120]
[54,76]
[55,93]
[56,100]
[57,123]
[58,159]
[59,49]
[60,81]
[61,123]
[62,129]
[63,66]
[64,73]
[65,102]
[66,112]
[67,90]
[68,87]
[69,81]
[70,38]
[71,83]
[72,72]
[73,113]
[74,87]
[75,109]
[76,76]
[77,64]
[78,101]
[79,88]
[80,56]
[81,61]
[82,127]
[83,62]
[84,65]
[85,85]
[86,31]
[87,96]
[88,50]
[89,31]
[90,75]
[91,61]
[92,51]
[93,78]
[94,64]
[95,54]
[96,49]
[97,69]
[98,79]
[99,22]
[100,32]
[101,32]
[102,52]
[103,60]
[104,41]
[105,114]
[106,48]
[107,40]
[108,58]
[109,26]
[110,21]
[111,61]
[112,47]
[113,50]
[114,34]
[115,52]
[116,51]
[117,24]
[118,34]
[119,108]
[120,23]
[121,41]
[122,38]
[123,39]
[124,20]
[125,88]
[126,34]
[127,57]
[128,50]
[129,54]
[130,69]
[131,90]
[132,43]
[133,42]
[134,9]
[135,38]
[136,63]
[137,8]
[138,53]
[139,53]
[140,69]
[141,49]
[142,70]
[143,48]
[144,81]
[145,22]
[146,68]
[147,39]
[148,34]
[149,13]
[150,33]
[151,68]
[152,30]
[153,20]
[154,78]
[155,10]
[156,48]
[157,32]
[158,70]
[159,36]
[160,32]
[161,68]
[162,23]
[163,20]
[164,42]
[165,22]
[166,40]
[168,27]
[169,52]
[170,12]
[171,41]
[172,23]
[173,52]
[174,29]
[175,58]
[176,42]
[178,16]
[179,21]
[180,30]
[181,9]
[182,10]
[183,41]
[184,32]
[185,20]
[186,20]
[187,30]
[188,26]
[189,20]
[190,10]
[191,28]
[192,32]
[193,12]
[194,62]
[195,27]
[196,12]
[197,12]
[198,10]
[199,30]
[200,22]
[201,19]
[202,30]
[203,39]
[204,9]
[205,10]
[206,32]
[207,24]
[208,12]
[209,10]
[210,20]
[213,29]
[214,10]
[215,10]
[216,21]
[218,20]
[219,2]
[220,28]
[221,9]
[222,13]
[223,20]
[224,10]
[225,10]
[226,10]
[227,10]
[228,10]
[229,2]
[230,20]
[232,40]
[234,10]
[235,10]
[236,10]
[237,10]
[238,2]
[240,6]
[241,19]
[242,10]
[244,20]
[249,20]
[250,10]
[251,30]
[252,18]
[253,6]
[254,19]
[255,20]
[256,9]
[260,19]
[262,19]
[264,10]
[265,19]
[266,10]
[267,10]
[268,10]
[269,10]
[270,18]
[271,18]
[273,20]
[275,10]
[277,21]
[278,9]
[280,10]
[282,19]
[283,10]
[289,9]
[293,12]
[294,8]
[295,40]
[300,10]
[302,9]
[303,10]
[305,10]
[306,10]
[316,10]
[321,10]
[323,10]
[328,10]
[332,9]
[370,10]
Filter stat join query count is 5734
All process is finish !
